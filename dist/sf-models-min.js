!function e(t,r,i){function n(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return n(r?r:e)},c,c.exports,e,t,r,i)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){"use strict";window.SFModels=e("./sf-models")},{"./sf-models":2}],2:[function(require,module,exports){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _salesforceSchemaReader=require("salesforce-schema-reader"),_salesforceSchemaReader2=_interopRequireDefault(_salesforceSchemaReader),SF,SFModels=SF={Ember:window&&window.Ember?window.Ember:void 0,DS:void 0,sforce:window&&window.sforce?window.sforce:void 0,SchemaReader:_salesforceSchemaReader2.default,_sfRelExt:"__r",_sfNameExt:"__c",_emRelExt:"rrr",_emNameExt:"ccc",endsWith:function(e,t){return e.indexOf(t,e.length-t.length)>-1},hasCustomSfRelationExtension:function(e){return SF.endsWith(e,SF._sfRelExt)},hasCustomSfNameExtension:function(e){return SF.endsWith(e,SF._sfNameExt)},hasCustomEmberRelationExtension:function(e){return SF.endsWith(e,SF._emRelExt)},hasCustomEmberNameExtension:function(e){return SF.endsWith(e,SF._emNameExt)},emberiseName:function(e){return SF.hasCustomSfNameExtension(e)?e=e.substring(0,e.length-SF._sfNameExt.length)+SF._emNameExt:SF.hasCustomSfRelationExtension(e)&&(e=e.substring(0,e.length-SF._sfRelExt.length)+SF._emRelExt),this.Ember.String.dasherize(e)},sfriseName:function(e){return e=this.Ember.String.camelize(e),SF.hasCustomEmberNameExtension(e)?e.substring(0,e.length-SF._emNameExt.length)+SF._sfNameExt:SF.hasCustomEmberRelationExtension(e)?e.substring(0,e.length-SF._emRelExt.length)+SF._sfRelExt:e},emberiseRefs:function(e){if("string"==typeof e)return SF.emberiseName(e);if(Array.isArray(e)){for(var t=[],r=0;r<e.length;r++)t.push(SF.emberiseName(e[r]));return t}return null},sfriseRefs:function(e){if("string"==typeof e)return SF.sfriseName(e);if(Array.isArray(e)){for(var t=[],r=0;r<e.length;r++)t.push(SF.sfriseName(e[r]));return t}return null},sforceToEmberTypeMap:{id:"string",boolean:"boolean",string:"string",datetime:"date",currency:"number",date:"date",email:"string",int:"number",double:"number",percent:"number",location:"string",phone:"string",picklist:"string",multipicklist:"string",textarea:"string",url:"string",address:"string",calculated:"string",combobox:"string",datacategorygroupreference:"string",encryptedstring:"string",junctionidlist:"string",masterrecord:"string"},createModelsForSObjects:function(e,t,r,i){var n=SF.createEmberModelDefinitions(t,r,i);SF.createModelsFromExtensionMap(e,n)},createModelsFromExtensionMap:function createModelsFromExtensionMap(emberApp,modelExtensionMap){var evaluatedMap={};for(var sObjectName in modelExtensionMap){var model=modelExtensionMap[sObjectName],evaluatedModel={};for(var key in model)"string"==typeof model[key]?evaluatedModel[key]=eval(model[key]):evaluatedModel[key]=model[key];var eon=SF.emberiseName(sObjectName);eon=this.Ember.String.dasherize(eon),emberApp[eon]=this.DS.Model.extend(evaluatedModel)}},createEmberModelDefinitions:function(e,t,r){var i={},n=new SF.factory.Cache;for(var a in e)r&&!r(e[a])||SF.recordInverses(a,t,n,r);for(var a in e)if(!r||r(e[a])){var o={};i[a]=o,SF.createFieldModelForSObject(o,a,t,n,r)}for(var a in e)if(!r||r(e[a])){var o=i[a];SF.createRelationshipModelForSObject(o,a,t,n,r)}return i},recordInverses:function(e,t,r,i){var n=function(n,a,o,s){"undefined"==typeof n.relationshipName||"undefined"==typeof n.childSObject||r.isReferencedByMultitypedReference(n)||i&&!i(t.completeMetas[n.childSObject])||r.logInverses(e,n.relationshipName,n.field)},a=t.completeMetas[e];t.shallowReadMetaChildRelationshipsAbr(a,n)},createFieldModelForSObject:function(e,t,r,i,n){var a=function(a,o,s,l){var d=a.name,c="true"===a.updateable;if(c||i.logNonUpdateableField(t,d),"reference"===a.type)if("string"==typeof a.referenceTo){var f=a.referenceTo;if(n&&!n(r.completeMetas[f]))return void(e[d]="this.DS.attr('string', {updateable : "+c+"})");"true"==a.custom&&(f=SF.emberiseName(f));var u=i.getInverse(t,d);null!=u?e[d]="this.DS.belongsTo('"+f+"', { async : true, updateable : "+c+", inverse : '"+u+"' })":e[d]="this.DS.belongsTo('"+f+"', { async : true, updateable : "+c+", inverse : null })"}else Array.isArray(a.referenceTo)?(i.logMultitypedReferenceField(t,d),e[d]="this.DS.attr('string', { multiRef : true, updateable : "+c+" })"):e[d]="this.DS.attr('string', {updateable : "+c+"})";else"Id"!==d&&(e[d]="this.DS.attr('"+SF.sforceToEmberTypeMap[a.type]+"', {updateable : "+c+"})");console.log(r.completeMetas.length+" : field : "+d)},o=r.completeMetas[t];r.shallowReadMetaFieldsAbr(o,a)},createRelationshipModelForSObject:function(e,t,r,i,n){var a=function(t,a,o,s){if("undefined"!=typeof t.relationshipName&&"undefined"!=typeof t.childSObject&&!i.isReferencedByMultitypedReference(t)&&(!n||n(r.completeMetas[t.childSObject]))){var l=t.relationshipName,d=SF.emberiseName(t.childSObject);e[l]="this.DS.hasMany('"+d+"', { async : true, inverse : '"+t.field+"', })",console.log("child rel : "+l)}},o=r.completeMetas[t];r.shallowReadMetaChildRelationshipsAbr(o,a)},createSoqlSelect:function(e,t,r,i){var n="select Id";return e.eachAttribute(function(e,t){n+=", "+e}),e.eachRelationship(function(e,t){n+=", ",n+="hasMany"===t.kind?"("+i(t.type,t.key)+")":t.key}),n+=" from "+t,"undefined"!=typeof r&&(n+=" where "+r),n},createRootSoqlSelect:function(e,t,r){return SF.createSoqlSelect(e,t,r,SF.createIdSoqlSelect)},createIdSoqlSelect:function(e,t,r){var i="select Id from "+t;return"undefined"!=typeof r&&(i+=" where "+r),i},toSoqlArray:function(e){for(var t="(",r=0;r<e.length;r++)t+=r>0?",'":"'",t+=e[r]+"'";return t+=")"},formatPayload:function(e,t){var r={},i=this.Ember.Inflector.inflector.pluralize(e.modelName);if(i=this.Ember.String.dasherize(i),Array.isArray(t.records)){for(var n=0;n<t.records.length;n++)SF.formatRecord(t.records[n]);r[i]=t.records}else 0===t.size?r[i]=[]:(SF.formatRecord(t.records),r[i]=[t.records]);return r},formatRecord:function(e){if(!e)return void console.log("rec is undefined");for(var t in e){var r=e[t];null!=r&&"undefined"!=typeof r.records&&(e[t]=SF.formatToIdArray(r.records))}"undefined"!=typeof e.Id&&(e.id=e.Id,delete e.Id)},formatToIdArray:function(e){var t=[];if(Array.isArray(e))for(var r=0;r<e.length;r++)t.push(e[r].Id);else t.push(e.Id);return t},sfFormatSnapshot:function(e,t){var r=this,i=SF.sfriseName(t.modelName),n=new this.sforce.SObject(i);return null!=e.id&&(n.Id=e.id),e.eachAttribute(function(i,a){var o=t.metaForProperty(i).options;o.updateable&&(n[i]=r.serialisePrimitive(e.attr(i)))}),e.eachRelationship(function(r,i){if("belongsTo"===i.kind){var a=t.metaForProperty(r).options;a.updateable&&(n[r]=e.belongsTo(r,{id:!0}))}}),n},serialisePrimitive:function(e){return e instanceof Date?e.toISOString():e},query:function(e,t,r,i,n){var a=null;try{var o=SF.sfriseName(t.modelName);a=SF.createRootSoqlSelect(t,o,r),this.sforce.connection.query(a,i,n)}catch(e){throw console.log(a),e}},createEmberModels:function(e){var t=e.connection,r=e.cb,i=e.objNames,n=e.owner?e.owner:{},a=new _salesforceSchemaReader2.default(t,100,function(){SF.createModelsForSObjects(n,a.completeMetas,a,typeFilter),r(n)},function(){r(null,"Failed to fetch salesforce schema definitions for the provided object names")},i)}};SFModels.factory={Cache:function(){this.nonUpdateableFields={},this.multitypedReferenceFields={},this.inversFields={};var e=this;this.logNonUpdateableField=function(t,r){e.nonUpdateableFields[t.toLowerCase()+"."+r.toLowerCase()]=!0},this.isUpdateableField=function(t,r){return!e.nonUpdateableFields[t.toLowerCase()+"."+r.toLowerCase()]},this.logMultitypedReferenceField=function(t,r){e.multitypedReferenceFields[t.toLowerCase()+"."+r.toLowerCase()]=!0},this.isMultitypedReferenceField=function(t,r){return e.multitypedReferenceFields[t.toLowerCase()+"."+r.toLowerCase()]},this.isReferencedByMultitypedReference=function(t){return e.isMultitypedReferenceField(t.childSObject,t.field)},this.getInversMap=function(t){var r=e.inversFields[t];return"undefined"!=typeof r&&null!=r||(r={},e.inversFields[t]=r),r},this.logInverses=function(t,r,i){var n=e.getInversMap(t);n[r]=i,n[i]=r},this.getInverse=function(t,r){var i=e.getInversMap(t)[r];return"undefined"==typeof i?null:i}}},exports.default=SFModels,module.exports=exports.default},{"salesforce-schema-reader":4}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},n=function(e,t,r,i,n){this.type="SchemaReader",this.connection=e,this.isFetching=!0,this.batchSize="undefined"==typeof t?100:t,this.skipErrors="undefined"==typeof i,this.readRelWithUdefNames=!1,"function"==typeof r&&this.populate(r,i,n)};n.prototype={populate:function(e,t,r){this.isFetching=!0,this.preMetas=[],this.completeMetas={},this.nameBatches=[];var i=0;if(r)this.preMetas=r;else{var n=this.connection.describeGlobal();this.preMetas=n.getArray("sobjects")}for(var a=0;a<this.preMetas.length;){for(var o=[],s=0;a<this.preMetas.length&&s<this.batchSize;a++,s++)o.push(this.preMetas[a].name);this.nameBatches.push(o)}for(var l=!1,d=!1,c=this,f=function(r){if(!d){if(l)return console.log(r),t(r),void(d=!0);i--,console.log(i),i<=0&&(c.isFetching=!1,e())}},u=function(e){c.skipErrors?console.log(e):(l=!0,t(e)),f(e)},a=0;a<this.nameBatches.length;a++)i++,console.log("Batch : "+this.nameBatches[a]),this.fetchCompleteMeta(this.nameBatches[a],f,u)},fetchCompleteMeta:function(e,t,r){var i=this,n=function(e){try{for(var n=0;n<e.length;n++)i.registerMeta(e[n])}catch(e){r(e)}finally{t()}};this.connection.describeSObjects(e,n,r)},registerMeta:function(e){this.completeMetas[e.name]=e},shallowReadFields:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.shallowReadMetaFieldsAbr(this.completeMetas[t],e))return"term"},shallowReadMetaFields:function(e,t,r,i){if(this.validateState(),"undefined"!=typeof e.fields)for(var n=0;n<e.fields.length;n++){var a=e.fields[n];if("undefined"!=typeof a){var o=r.concat(a);if("term"===i(a,e,o,this))return"term"}}},shallowReadMetaFieldsAbr:function(e,t){return this.shallowReadMetaFields(e,{},[],t)},deepReadFields:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.deepReadMetaFieldsAbr(this.completeMetas[t],e))return"term"},deepReadMetaFields:function(e,t,r,n){if(this.validateState(),1!=t[e.name]&&"undefined"!=typeof e.fields){t[e.name]=!0,0==r.length&&r.push(e);for(var a=0;a<e.fields.length;a++){var o=e.fields[a];if("undefined"!=typeof o){var s=r.concat(o);if("term"===n(o,e,s,this))return"term";if("reference"===o.type)if(Array.isArray(o.referenceTo)){for(var l=0;l<o.referenceTo.length;l++)if("term"===this.deepReadMetaFields(this.completeMetas[o.referenceTo[l]],i(t),s,n))return"term"}else if("term"===this.deepReadMetaFields(this.completeMetas[o.referenceTo],i(t),s,n))return"term"}}}},deepReadMetaFieldsAbr:function(e,t){return this.deepReadMetaFields(e,[],[],t)},shallowReadChildRelationships:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.shallowReadMetaChildRelationshipsAbr(this.completeMetas[t],e))return"term"},shallowReadMetaChildRelationships:function(e,t,r,i){if(this.validateState(),"undefined"!=typeof e.childRelationships)for(var n=0;n<e.childRelationships.length;n++){var a=e.childRelationships[n];if("undefined"!=typeof a){var o=r.concat(a);if("term"===i(a,e,o,this))return"term"}}},shallowReadMetaChildRelationshipsAbr:function(e,t){return this.shallowReadMetaChildRelationships(e,{},[],t)},deepReadChildRelationships:function(e){this.validateState();for(var t in this.completeMetas)if("term"===this.deepReadMetaChildRelationshipsAbr(this.completeMetas[t],e))return"term"},deepReadMetaChildRelationships:function(e,t,r,n){if(this.validateState(),1!=t[e.name]&&"undefined"!=typeof e.childRelationships){t[e.name]=!0,0==r.length&&r.push(e);for(var a=0;a<e.childRelationships.length;a++){var o=e.childRelationships[a];if("undefined"!=typeof o){var s=r.concat(o);if("term"===n(o,e,s,this))return"term";if(Array.isArray(o.childSObject)){for(var l=0;l<o.childSObject.length;l++)if("term"===this.deepReadMetaChildRelationships(this.completeMetas[o.childSObject[l]],i(t),s,n))return"term"}else if("term"===this.deepReadMetaChildRelationships(this.completeMetas[o.childSObject],i(t),s,n))return"term"}}}},deepReadMetaChildRelationshipsAbr:function(e,t){return this.deepReadMetaChildRelationships(e,{},[],t)},validateState:function(){if(this.isFetching)throw this.type+" hasn't finished fetching metadata from the server"}},n.createFilterVisitor=function(e,t){return function(r,i,n,a){e(r,i,n,a)&&t(r,i,n,a)}},n.newObjectNameFilter=function(e,t,r){return function(i,n,a,o){(!r&&e.toLowerCase()===n.name.toLowerCase()||r&&e===n.name)&&t(i,n,a,o)}},n.newFieldNameFilter=function(e,t,r){return function(i,n,a,o){(!r&&e.toLowerCase()===i.name.toLowerCase()||r&&e===i.name)&&t(i,n,a,o)}},n.newFieldAndObjectNameFilter=function(e,t,r,i){return function(n,a,o,s){(!i&&e.toLowerCase()===n.name.toLowerCase()||i&&e===n.name)&&(!i&&t.toLowerCase()===a.name.toLowerCase()||i&&t===a.name)&&r(n,a,o,s)}},n.concatPath=function(e){for(var t="",r=0;r<e.length;r++)t+=(r>0?".":"")+(e[r].name?e[r].name:e[r].relationshipName);return t},r.default=n,t.exports=r.default},{}],4:[function(e,t,r){t.exports=e("./dist/schema-reader-node.js")},{"./dist/schema-reader-node.js":3}]},{},[1]);
//# sourceMappingURL=sf-models-min.map